<!DOCTYPE html>
<html lang="zh-Hans">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width">
<title>javascript操作样式</title>
<link rel="stylesheet" href="../../theme/static/css/common.css" />
</head>
<body>
<header>
<h1>涂鸦</h1>
</header>
<nav>
<ul>
<li><a href="../../index.html" title="index">INDEX</a></li>
<li><a href="../../category.html" title="category">CATEGORY</a></li>
<li><a href="../../tag.html" title="tag">TAG</a></li>
<li><a href="../../link.html" title="link">LINK</a></li>
<li><a href="../../about.html" title="about">ABOUT</a></li>
</ul>
</nav>
<article id="post">
<h1>javascript</h1>

<h2>style &amp; offset</h2>

<hr />

<p>~~~~ {.javascript}
function setStyle(el, prop, val) {}
function getStyle(el, prop) {}
function offsetX(el) {}
function offsetY(el) {}
~~~~</p>

<hr />

<h3>style</h3>

<h4>property name</h4>

<p>将属性由连字符转换为小骆驼</p>

<p>~~~~ {.javascript}
prop = prop.replace(/-([a-z])/ig, function(all, letter) {
    return letter.toUpperCase();
});
~~~~</p>

<h4>float</h4>

<p>float是js的保留字，w3c使用cssFloat代替，ie使用styleFloat代替。
解决的思路就是在设置和取值的时候查看是否为float，是的话，替换掉。
具体实现是使用一个对象（PROPS）保存需要特殊处理的属性名（这里是float），
检查传入的属性名是否在这个对象（PROPS）里。
这样便于拓展，因为需要特殊处理的还真不止float一个。</p>

<p>~~~~ {.javascript}
PROPS = {
    'float': !!el.style.cssFloat ? cssFloat : styleFloat;
    //不支持cssFloat的浏览器返回的是undefined
};
~~~~</p>

<h4>setStyle</h4>

<p>最简单的方法就是直接设置inline style了。</p>

<p>~~~~ {.javascript}
/**
 * @param {HTMLElement} el An HTMLElement to apply the style to.
 * @param {String} prop The style property to set.
 * @param {String} val The value.
 */
function setStyle(el, prop, val) {
    el.style[prop] = val;
}
~~~~</p>

<p>为了兼容性，需要做一些拓展。
如果要支持用数字对width，height等等赋值，要对val进行处理，我不管了。</p>

<p>~~~~ {.javascript}
function setStyle(el, prop, val) {
    // 重置样式，比如setStyle(el, prop)这样的情况
    if (val === null || val === '') val = '';</p>

<pre><code>// 处理特殊样式
if (prop in PROPS) {
    if (typeof PROPS[prop] === 'string') {
        prop = PROPS[prop]; // float的处理就在这里了
    }
}

el.style[prop] = val;
</code></pre>

<p>}
~~~~</p>

<h4>getStyle</h4>

<p>有一种东西叫做计算样式（computedStyle），也就是浏览器最后应用的样式。</p>

<p>~~~~ {.javascript}
/**
 * @param {HTMLElement} el An HTMLElement to apply the style to.
 * @param {String} prop The style property to set.
 */
function getStyle(el, prop) {
    if (document.defaultView &amp;&amp; document.defaultView.getComputedStyle)
        style = document.defaultView.getComputedStyle(el, null);
    return style[prop];
}
~~~~</p>

<p>这个就是基本的用法了。
不支持<code>getComputedStyle</code>的ie有<code>el.currentStyle</code>这么个属性，
用法基本一样<code>el.currentStyle[prop]</code>。</p>

<hr />

<p>先这样了，下次更新ie单位。</p>

</article>
</body>
</html>
