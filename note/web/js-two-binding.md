# two-way binding

---

https://svelte.technology/guide#two-way-binding
https://reactjs.org/docs/two-way-binding-helpers.html

---

最近突然在想前端框架的事情。
讲到框架，不得不提的一点是状态管理。
单一数据源，分型组件，单向传递的数据流，都是很棒的想法。

不过，事情没这么简单……

---

将数据分为 prop 和 state，就像函数的参数和内部变量。
组件向下传递数据，向上传递事件，没有其他依赖。
理念是很好的，但很多时候数据都是透传，只是在增加工作量。

独立组件的优势是复用、可独立测试。
这些优势带来的收益，小于编码的繁琐，结果可想而知。

我也想过纯 UI 的组件，是不是应该遵循这样的规范。
但是，业务使用，都会在 UI 上进行再次封装。
这种做法始终是无法向更大范围推广。

像 redux / context 等做法，在我看来是不再坚持分型了。

这里的问题在哪里呢？
我认为问题大概在数据。
组件本身的样式、逻辑，SFC 是一个很好的答案，实现了组件的隔离和组合。
但如何对数据进行隔离和组合，没有很好的方案。

---

另一个是单向数据流的问题。

我之前认为，双向绑定的问题是回调带来的不确定性。
但在处理简单的表单等交互时，双向绑定又确实又极大的效率提升。
这里面有没有一个更好的选择呢？

这里有一个渲染的问题。

- 页面交互～数据变化～生成 VDOM ～比较 VDOM ～更新 DOM
- 页面交互～数据变化～更新 DOM

双向绑定的方案，节省了 VDOM 生成和比较，理应比 VDOM 要快的。
要追溯数据变化，理论上一样是可以做到的。
所以，按说双向绑定完胜才对吧。
问题到底在哪？

不管是双向绑定还是单向数据流
对于相同的业务逻辑，要执行的操作是差不多的
不同的应该是谁是动作的发出者

假设有一些基础数据，也就是自变量，比如“姓”和“名”
然后有一些组合数据，也就是因变量，比如“姓名”
在单向数据流里，修改“姓”“名”的人，要主动去修改“姓名”
而在双向绑定里，修改“姓”“名”后，之前注册的回调会自动修改“姓名”，是“姓名”主动监听了“姓”“名”的变化
两种方式哪种更合理？哪种可扩展性更强？
从数据解耦的角度说，应该是双向绑定更好才对。
自变量本就不需要知道因变量存在的。

如果从头到尾都是双向绑定好，那么问题到底在哪？
应该是业务复杂之后，大量的主动监听使得数据流混乱不堪。
要解决这个问题，应该怎么操作呢？
是不是可以通过静态分析梳理出整个数据流？
RxJS 之类的框架，会不会让流程更清晰？

---

前端的未来，会是什么样的呢？
