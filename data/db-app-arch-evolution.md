# db

---

今天又看了一篇讲应用架构演化的。

---

最开始，只分“应用层”和“数据层”。
多个上层应用共用一个数据库。

---

请求多了之后，扛不住。
数据层做了读写分离。
从库可以水平扩展。

这时候的问题是主从延迟。
进行一系列调优。从数据库的参数，到机器性能增强。
关键的操作，选择直接读主库，避免主从同步不及时。

---

主从库可以缓解读压力，解决不了写压力。

于是应用不再共用一个数据库。
性能和稳定性都会有提升。

代价是需要改动业务层。
无法跨数据库进行 join，很多之前的代码要处理。

---

数据量持续增大后，单表太大太慢，所以上水平分库。
在“业务层”和“数据层”之间增加一个“数据访问层”，屏蔽分库的使用细节。
